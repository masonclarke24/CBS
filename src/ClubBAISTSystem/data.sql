USE [CBS]
GO

INSERT [dbo].[MembershipLevels] ([MembershipLevel]) VALUES (N'Bronze')
GO
INSERT [dbo].[MembershipLevels] ([MembershipLevel]) VALUES (N'Gold  ')
GO
INSERT [dbo].[MembershipLevels] ([MembershipLevel]) VALUES (N'Silver')
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'07:00:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'07:07:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'07:15:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'07:22:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'07:30:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'07:37:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'07:45:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'07:52:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'08:00:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'08:07:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'08:15:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'08:22:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'08:30:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'08:37:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'08:45:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'08:52:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'09:00:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'09:07:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'09:15:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'09:22:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'09:30:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'09:37:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'09:45:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'09:52:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'10:00:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'10:07:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'10:15:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'10:22:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'10:30:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'10:37:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'10:45:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'10:52:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'11:00:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'11:07:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'11:15:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'11:22:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'11:30:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'11:37:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'11:45:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'11:52:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'12:00:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'12:07:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'12:15:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'12:22:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'12:30:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'12:37:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'12:45:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'12:52:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'13:00:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'13:07:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'13:15:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'13:22:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'13:30:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'13:37:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'13:45:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'13:52:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'14:00:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'14:07:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'14:15:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'14:22:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'14:30:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'14:37:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'14:45:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'14:52:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'15:00:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'15:07:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'15:15:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'15:22:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'15:30:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'15:37:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'15:45:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'15:52:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'16:00:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'16:07:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'16:15:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'16:22:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'16:30:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'16:37:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'16:45:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'16:52:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'17:00:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'17:07:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'17:15:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'17:22:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'17:30:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'17:37:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'17:45:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'17:52:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'18:00:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'18:07:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'18:15:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'18:22:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'18:30:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'18:37:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'18:45:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'18:52:00' AS Time))
GO
INSERT [dbo].[PermissableTeeTimes] ([Time]) VALUES (CAST(N'19:00:00' AS Time))
GO

CREATE TABLE #Weekdays
(
	[DayOfWeek] INT NOT NULL
)

INSERT INTO #Weekdays([DayOfWeek]) VALUES (2),(3),(4),(5),(6)

DECLARE cursorDaysOfWeek SCROLL CURSOR
FOR SELECT [DayOfWeek] FROM #Weekdays

DECLARE @weekday INT

OPEN cursorDaysOfWeek

FETCH NEXT FROM cursorDaysOfWeek INTO @weekday

--Insert Gold permissable time for weekday
WHILE @@FETCH_STATUS = 0
	BEGIN
		INSERT INTO TeeTimesForMembershipLevel([Time], [DayOfWeek], MembershipLevel)
			SELECT [Time], @weekday, 'Gold' FROM PermissableTeeTimes
		FETCH NEXT FROM cursorDaysOfWeek INTO @weekday
	END

--Insert Silver permissable times for weekdsy
 FETCH FIRST FROM cursorDaysOfWeek INTO @weekday

 WHILE @@FETCH_STATUS = 0
	BEGIN
		INSERT INTO TeeTimesForMembershipLevel([Time], [DayOfWeek], MembershipLevel)
			SELECT [Time], @weekday, 'Silver' FROM PermissableTeeTimes
			WHERE DATEDIFF(HOUR,[Time], CAST(N'15:00:00' AS Time)) > 0 OR DATEDIFF(MINUTE,[Time], CAST(N'17:30:00' AS Time)) < 0
		FETCH NEXT FROM cursorDaysOfWeek INTO @weekday
	END

--Insert Bronze permissable times for weekdsy
FETCH FIRST FROM cursorDaysOfWeek INTO @weekday
WHILE @@FETCH_STATUS = 0
	BEGIN
		INSERT INTO TeeTimesForMembershipLevel([Time], [DayOfWeek], MembershipLevel)
			SELECT [Time], @weekday, 'Bronze' FROM PermissableTeeTimes
			WHERE DATEDIFF(HOUR,[Time], CAST(N'15:00:00' AS Time)) > 0 OR DATEDIFF(MINUTE,[Time], CAST(N'18:00:00' AS Time)) < 0
		FETCH NEXT FROM cursorDaysOfWeek INTO @weekday
	END

DELETE #Weekdays

INSERT INTO #Weekdays VALUES(1),(7)

CLOSE cursorDaysOfWeek
DEALLOCATE cursorDaysOfWeek
GO

DECLARE cursorDaysOfWeek SCROLL CURSOR
FOR SELECT [DayOfWeek] FROM #Weekdays

DECLARE @weekday INT

OPEN cursorDaysOfWeek

FETCH NEXT FROM cursorDaysOfWeek INTO @weekday

--Insert Gold permissable tee time for weekend

WHILE @@FETCH_STATUS = 0
	BEGIN
		INSERT INTO TeeTimesForMembershipLevel([Time], [DayOfWeek], MembershipLevel)
			SELECT [Time], @weekday, 'Gold' FROM PermissableTeeTimes
		FETCH NEXT FROM cursorDaysOfWeek INTO @weekday
	END

--Insert Silver permissable times for weekend
 FETCH FIRST FROM cursorDaysOfWeek INTO @weekday

 WHILE @@FETCH_STATUS = 0
	BEGIN
		INSERT INTO TeeTimesForMembershipLevel([Time], [DayOfWeek], MembershipLevel)
			SELECT [Time], @weekday, 'Silver' FROM PermissableTeeTimes
			WHERE DATEDIFF(HOUR,[Time], CAST(N'11:00:00' AS Time)) < 0
		FETCH NEXT FROM cursorDaysOfWeek INTO @weekday
	END

--Insert Bronze permissable times for weekend
 FETCH FIRST FROM cursorDaysOfWeek INTO @weekday

 WHILE @@FETCH_STATUS = 0
	BEGIN
		INSERT INTO TeeTimesForMembershipLevel([Time], [DayOfWeek], MembershipLevel)
			SELECT [Time], @weekday, 'Bronze' FROM PermissableTeeTimes
			WHERE DATEDIFF(HOUR,[Time], CAST(N'13:00:00' AS Time)) < 0
		FETCH NEXT FROM cursorDaysOfWeek INTO @weekday
	END

CLOSE cursorDaysOfWeek
DEALLOCATE cursorDaysOfWeek
DROP TABLE #Weekdays

--DELETE TeeTimesForMembershipLevel
SELECT * FROM TeeTimesForMembershipLevel


